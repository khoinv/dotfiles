export PREVPWD=`pwd`
export PREVPWD=`pwd`
export PREVENV_PATH=

handle_virtualenv(){
    if [ "$PWD" != "PREVPWD" ]; then
        PREPWD="$PWD";
        if [ -n "$PREVENV_PATH" ]; then
            if [ "`echo "$PWD" | grep -c $PREVENV_PATH`" = "0" ]; then
                deactivate
                unalias python 2> /dev/null
                PREVENV_PATH=
                fi
                fi
                
# activate virtualenv dynamically
                if [ -e "$PWD/.venv" ] && [ "$PWD" != "$PREVENV_PATH" ]; then
                    PREVENV_PATH="$PWD"
                    workon `basename $PWD`
                    fi
                    fi
}

export PROMPT_COMMAND=handle_virtualenv

export VIRTUALENVWRAPPER_VIRTUALENV_ARGS='--no-site-packages'
export WORKON_HOME=~/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh
